<AssistantPage>
    <Title>Microsoft SQL Connection<span>@session?.ToMarkupString()</span></Title>
    <Body>
        <p>There isn't any description on this page yet.</p>
        <MicrosoftSqlConnection sqlServer="sqlServer" onDisconnect="this.RenderLater" />
        <MicrosoftSqlConnectionDatabase sqlServer="sqlServer" />
    </Body>
    <BottomLeft><Button onClick="Back">Back</Button></BottomLeft>
    <BottomRight><Button onClick="Next" isEnabled="sqlServer.database != string.Empty">Next</Button></BottomRight>
</AssistantPage>

@code {

    static Config.BC.RemoteMachine.ServerInstance.SqlServer sqlServer
        => Config.Instance.bc.remoteMachine.oldServerInstance.sqlServer;

    [Parameter] public Action onBack { get; set; }
    [Parameter] public Action onNext { get; set; }

    PowerShellSession session;

    protected override async Task OnInitializedAsync()
    {
        await App.Instance.IncreaseBusinessAsync();

        session = await sqlServer.serverInstance.remoteMachine.GetSessionAsync();

        await App.Instance.DecreaseBusinessAsync();
    }

    void Back()
    {
        onBack?.Invoke();
    }

    void Next()
    {
        onNext?.Invoke();
    }

}
